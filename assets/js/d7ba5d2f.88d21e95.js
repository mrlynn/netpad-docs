"use strict";(self.webpackChunkdocs_netpad_io=self.webpackChunkdocs_netpad_io||[]).push([[3864],{1952:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"api/vercel-integration","title":"Vercel Integration API","description":"These endpoints support the Vercel Integration for automated deployment and configuration of NetPad instances.","source":"@site/docs/api/vercel-integration.md","sourceDirName":"api","slug":"/api/vercel-integration","permalink":"/docs/api/vercel-integration","draft":false,"unlisted":false,"editUrl":"https://github.com/mrlynn/netpad-v3/tree/main/docs/docs/api/vercel-integration.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"Webhooks","permalink":"/docs/api/webhooks"},"next":{"title":"Security Overview","permalink":"/docs/security/overview"}}');var i=r(4848),t=r(8453);const l={},o="Vercel Integration API",c={},d=[{value:"Get Environment Variables Template",id:"get-environment-variables-template",level:2},{value:"Push Environment Variables to Vercel Project",id:"push-environment-variables-to-vercel-project",level:2},{value:"Vercel OAuth Callback",id:"vercel-oauth-callback",level:2},{value:"Provision MongoDB Atlas Cluster",id:"provision-mongodb-atlas-cluster",level:2},{value:"Integration Flow",id:"integration-flow",level:2},{value:"Environment Variables Reference",id:"environment-variables-reference",level:2},{value:"Error Handling",id:"error-handling",level:2},{value:"Common Errors",id:"common-errors",level:3},{value:"Example Error Response",id:"example-error-response",level:3},{value:"Related",id:"related",level:2}];function a(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"vercel-integration-api",children:"Vercel Integration API"})}),"\n",(0,i.jsx)(n.p,{children:"These endpoints support the Vercel Integration for automated deployment and configuration of NetPad instances."}),"\n",(0,i.jsx)(n.h2,{id:"get-environment-variables-template",children:"Get Environment Variables Template"}),"\n",(0,i.jsx)(n.p,{children:"Retrieve the environment variables needed for deployment, optionally pre-filled with organization data."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-http",children:"GET /api/integrations/vercel/env\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Authentication:"})," Session authentication required"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Query Parameters:"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Required"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"organizationId"})}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"No"}),(0,i.jsx)(n.td,{children:"Organization ID to get pre-filled values"})]})})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example Request (Template Only):"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl -X GET "https://your-domain.com/api/integrations/vercel/env" \\\n  -H "Authorization: Bearer your_session_token"\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example Response:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "envVars": {\n    "MONGODB_URI": {\n      "value": "",\n      "description": "MongoDB connection string. Get from MongoDB Atlas.",\n      "required": true\n    },\n    "MONGODB_DATABASE": {\n      "value": "forms",\n      "description": "Database name for NetPad data.",\n      "required": true\n    },\n    "SESSION_SECRET": {\n      "value": "auto-generated-64-char-hex",\n      "description": "Secret key for session encryption. Auto-generated.",\n      "required": true\n    },\n    "VAULT_ENCRYPTION_KEY": {\n      "value": "auto-generated-base64-key",\n      "description": "Key for vault encryption. Auto-generated.",\n      "required": true\n    },\n    "NEXT_PUBLIC_APP_URL": {\n      "value": "${VERCEL_URL}",\n      "description": "Public URL of your app. Use ${VERCEL_URL} for auto-detection.",\n      "required": true\n    }\n  }\n}\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"push-environment-variables-to-vercel-project",children:"Push Environment Variables to Vercel Project"}),"\n",(0,i.jsx)(n.p,{children:"Push environment variables to a connected Vercel project."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-http",children:"POST /api/integrations/vercel/env\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Authentication:"})," Session authentication and Vercel integration installed"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Request Body:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "installationId": "oac_xxx",\n  "projectId": "prj_xxx",\n  "organizationId": "org_xxx"\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example Request:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl -X POST "https://your-domain.com/api/integrations/vercel/env" \\\n  -H "Authorization: Bearer your_session_token" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "installationId": "oac_xxx",\n    "projectId": "prj_xxx",\n    "organizationId": "org_xxx"\n  }\'\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example Response:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "message": "Environment variables configured successfully",\n  "envVarsSet": [\n    "MONGODB_URI",\n    "MONGODB_DATABASE",\n    "SESSION_SECRET",\n    "VAULT_ENCRYPTION_KEY",\n    "NEXT_PUBLIC_APP_URL",\n    "APP_URL"\n  ]\n}\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"vercel-oauth-callback",children:"Vercel OAuth Callback"}),"\n",(0,i.jsx)(n.p,{children:"Handle OAuth callback from Vercel Integration installation."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-http",children:"GET /api/integrations/vercel/callback\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Query Parameters:"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"code"})}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"OAuth authorization code from Vercel"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"configurationId"})}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"Vercel configuration ID"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"teamId"})}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"Optional Vercel team ID"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"next"})}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"Redirect URL after installation"})]})]})]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsx)(n.p,{children:"This endpoint is called automatically by Vercel during integration installation. You typically won't call this directly."})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"provision-mongodb-atlas-cluster",children:"Provision MongoDB Atlas Cluster"}),"\n",(0,i.jsx)(n.p,{children:"Provision a new MongoDB Atlas M0 cluster for Vercel deployments."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-http",children:"POST /api/integrations/vercel/provision\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Authentication:"})," Session authentication required"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Request Body:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "installationId": "oac_xxx",\n  "organizationId": "org_xxx"\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example Request:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl -X POST "https://your-domain.com/api/integrations/vercel/provision" \\\n  -H "Authorization: Bearer your_session_token" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "installationId": "oac_xxx",\n    "organizationId": "org_xxx"\n  }\'\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example Response:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "message": "MongoDB cluster provisioned successfully",\n  "clusterName": "netpad-cluster-abc123",\n  "database": "forms",\n  "envVars": {\n    "MONGODB_URI": "mongodb+srv://...",\n    "MONGODB_DATABASE": "forms",\n    "SESSION_SECRET": "auto-generated",\n    "VAULT_ENCRYPTION_KEY": "auto-generated"\n  }\n}\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"integration-flow",children:"Integration Flow"}),"\n",(0,i.jsx)(n.p,{children:"The Vercel integration follows this flow:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   User clicks   \u2502\u2500\u2500\u2500\u2500>\u2502  Vercel OAuth   \u2502\u2500\u2500\u2500\u2500>\u2502   Callback to   \u2502\n\u2502  "Add to Vercel"\u2502     \u2502   Authorization \u2502     \u2502    /callback    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                                         \u2502\n                                                         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Deployment    \u2502<\u2500\u2500\u2500\u2500\u2502  Push env vars  \u2502<\u2500\u2500\u2500\u2500\u2502  Configure      \u2502\n\u2502    Complete     \u2502     \u2502  to Vercel      \u2502     \u2502  env vars       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n'})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"User initiates"}),': Clicks "Deploy to Vercel" button']}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"OAuth flow"}),": User authorizes NetPad to access their Vercel account"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Callback"}),": Vercel redirects to ",(0,i.jsx)(n.code,{children:"/api/integrations/vercel/callback"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Configuration"}),": User configures environment variables"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Push"}),": Environment variables are pushed to the Vercel project"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Deploy"}),": Vercel builds and deploys the application"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"environment-variables-reference",children:"Environment Variables Reference"}),"\n",(0,i.jsx)(n.p,{children:"The integration automatically configures these environment variables:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Variable"}),(0,i.jsx)(n.th,{children:"Description"}),(0,i.jsx)(n.th,{children:"Auto-Generated"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"MONGODB_URI"})}),(0,i.jsx)(n.td,{children:"MongoDB connection string"}),(0,i.jsx)(n.td,{children:"No (user provides)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"MONGODB_DATABASE"})}),(0,i.jsx)(n.td,{children:"Database name"}),(0,i.jsxs)(n.td,{children:["Yes (default: ",(0,i.jsx)(n.code,{children:"forms"}),")"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"SESSION_SECRET"})}),(0,i.jsx)(n.td,{children:"Session encryption key"}),(0,i.jsx)(n.td,{children:"Yes"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"VAULT_ENCRYPTION_KEY"})}),(0,i.jsx)(n.td,{children:"Vault encryption key"}),(0,i.jsx)(n.td,{children:"Yes"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"NEXT_PUBLIC_APP_URL"})}),(0,i.jsx)(n.td,{children:"Public application URL"}),(0,i.jsxs)(n.td,{children:["Yes (uses ",(0,i.jsx)(n.code,{children:"${VERCEL_URL}"}),")"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"APP_URL"})}),(0,i.jsx)(n.td,{children:"Server-side application URL"}),(0,i.jsxs)(n.td,{children:["Yes (uses ",(0,i.jsx)(n.code,{children:"${VERCEL_URL}"}),")"]})]})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,i.jsx)(n.h3,{id:"common-errors",children:"Common Errors"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Error Code"}),(0,i.jsx)(n.th,{children:"Description"}),(0,i.jsx)(n.th,{children:"Resolution"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"INTEGRATION_NOT_INSTALLED"})}),(0,i.jsx)(n.td,{children:"Vercel integration not installed"}),(0,i.jsx)(n.td,{children:"Install the integration first"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"INVALID_INSTALLATION_ID"})}),(0,i.jsx)(n.td,{children:"Installation ID not found"}),(0,i.jsx)(n.td,{children:"Verify the installation ID"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"PERMISSION_DENIED"})}),(0,i.jsx)(n.td,{children:"Insufficient Vercel permissions"}),(0,i.jsx)(n.td,{children:"Re-authorize with correct scopes"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"PROJECT_NOT_FOUND"})}),(0,i.jsx)(n.td,{children:"Vercel project not found"}),(0,i.jsx)(n.td,{children:"Verify project ID"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"PROVISIONING_FAILED"})}),(0,i.jsx)(n.td,{children:"MongoDB provisioning failed"}),(0,i.jsx)(n.td,{children:"Check Atlas API credentials"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"example-error-response",children:"Example Error Response"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "success": false,\n  "error": {\n    "code": "INTEGRATION_NOT_INSTALLED",\n    "message": "Vercel integration is not installed for this organization",\n    "details": {\n      "organizationId": "org_xxx"\n    }\n  }\n}\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"related",children:"Related"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/docs/deployment/vercel",children:"Deploy to Vercel"})," - Complete deployment guide"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/docs/api/overview",children:"API Overview"})," - API authentication and basics"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>l,x:()=>o});var s=r(6540);const i={},t=s.createContext(i);function l(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);