"use strict";(self.webpackChunkdocs_netpad_io=self.webpackChunkdocs_netpad_io||[]).push([[3455],{3275:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>x,frontMatter:()=>o,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"extensions/api-reference","title":"API Reference","description":"Complete API documentation for the NetPad extension system","source":"@site/docs/extensions/api-reference.md","sourceDirName":"extensions","slug":"/extensions/api-reference","permalink":"/docs/extensions/api-reference","draft":false,"unlisted":false,"editUrl":"https://github.com/mrlynn/netpad-v3/tree/main/docs/docs/extensions/api-reference.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"API Reference","description":"Complete API documentation for the NetPad extension system"},"sidebar":"docs","previous":{"title":"Workflow Node Extensions","permalink":"/docs/extensions/workflow-nodes"},"next":{"title":"Example: Collaborate Extension","permalink":"/docs/extensions/example-collaborate"}}');var i=t(4848),r=t(8453);const o={sidebar_position:4,title:"API Reference",description:"Complete API documentation for the NetPad extension system"},a="Extension API Reference",l={},d=[{value:"Core Interfaces",id:"core-interfaces",level:2},{value:"NetPadExtension",id:"netpadextension",level:3},{value:"ExtensionMetadata",id:"extensionmetadata",level:3},{value:"ExtensionRoute",id:"extensionroute",level:3},{value:"ExtensionMiddleware",id:"extensionmiddleware",level:3},{value:"ExtensionFeature",id:"extensionfeature",level:3},{value:"Registry Functions",id:"registry-functions",level:2},{value:"registerExtension",id:"registerextension",level:3},{value:"getExtension",id:"getextension",level:3},{value:"isFeatureAvailable",id:"isfeatureavailable",level:3},{value:"getFeatureAvailability",id:"getfeatureavailability",level:3},{value:"getExtensionRoutes",id:"getextensionroutes",level:3},{value:"getExtensionMiddleware",id:"getextensionmiddleware",level:3},{value:"getService",id:"getservice",level:3},{value:"getRegistryStatus",id:"getregistrystatus",level:3},{value:"initializeExtensions",id:"initializeextensions",level:3},{value:"cleanupExtensions",id:"cleanupextensions",level:3},{value:"resetRegistry",id:"resetregistry",level:3},{value:"Loader Functions",id:"loader-functions",level:2},{value:"loadExtensions",id:"loadextensions",level:3},{value:"extensionsLoaded",id:"extensionsloaded",level:3},{value:"waitForExtensions",id:"waitforextensions",level:3},{value:"registerExtensionManually",id:"registerextensionmanually",level:3},{value:"resetLoader",id:"resetloader",level:3},{value:"Environment Variables",id:"environment-variables",level:2},{value:"NETPAD_CLOUD",id:"netpad_cloud",level:3},{value:"NETPAD_EXTENSIONS",id:"netpad_extensions",level:3},{value:"NETPAD_SELF_HOSTED",id:"netpad_self_hosted",level:3},{value:"Route Handler Patterns",id:"route-handler-patterns",level:2},{value:"Basic GET Handler",id:"basic-get-handler",level:3},{value:"POST Handler with Body Parsing",id:"post-handler-with-body-parsing",level:3},{value:"Handler with URL Parameters",id:"handler-with-url-parameters",level:3},{value:"Handler with Query Parameters",id:"handler-with-query-parameters",level:3},{value:"Middleware Patterns",id:"middleware-patterns",level:2},{value:"Authentication Middleware",id:"authentication-middleware",level:3},{value:"Logging Middleware",id:"logging-middleware",level:3},{value:"Rate Limiting Middleware",id:"rate-limiting-middleware",level:3},{value:"Component Export Patterns",id:"component-export-patterns",level:2},{value:"Basic Component Export",id:"basic-component-export",level:3},{value:"With Component IDs",id:"with-component-ids",level:3},{value:"Type Utilities",id:"type-utilities",level:2},{value:"Type-Safe Service Access",id:"type-safe-service-access",level:3},{value:"Extension Type Guards",id:"extension-type-guards",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"Standard Error Response",id:"standard-error-response",level:3},{value:"Error Codes",id:"error-codes",level:3},{value:"Workflow Node Types",id:"workflow-node-types",level:2},{value:"WorkflowNodeDefinition",id:"workflownodedefinition",level:3},{value:"NodeConfigField",id:"nodeconfigfield",level:3},{value:"NodeOutput",id:"nodeoutput",level:3},{value:"NodeHandler",id:"nodehandler",level:3},{value:"NodeExecutionContext",id:"nodeexecutioncontext",level:3},{value:"NodeExecutionResult",id:"nodeexecutionresult",level:3},{value:"ExtensionWorkflowNode",id:"extensionworkflownode",level:3},{value:"Workflow Node Registry Functions",id:"workflow-node-registry-functions",level:2},{value:"registerExtensionNode",id:"registerextensionnode",level:3},{value:"getExtensionNodeDefinitions",id:"getextensionnodedefinitions",level:3},{value:"getExtensionNodesByCategory",id:"getextensionnodesbycategory",level:3},{value:"isExtensionNode",id:"isextensionnode",level:3},{value:"Next Steps",id:"next-steps",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"extension-api-reference",children:"Extension API Reference"})}),"\n",(0,i.jsx)(n.p,{children:"Complete API documentation for building NetPad extensions."}),"\n",(0,i.jsx)(n.h2,{id:"core-interfaces",children:"Core Interfaces"}),"\n",(0,i.jsx)(n.h3,{id:"netpadextension",children:"NetPadExtension"}),"\n",(0,i.jsx)(n.p,{children:"The main interface that all extensions must implement."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface NetPadExtension {\n  /** Extension metadata */\n  metadata: ExtensionMetadata;\n\n  /** Features provided by this extension */\n  features: ExtensionFeature[];\n\n  /** API routes (optional) */\n  routes?: ExtensionRoute[];\n\n  /** Request middleware (optional) */\n  middleware?: ExtensionMiddleware[];\n\n  /** Shared services (optional) */\n  services?: Record<string, unknown>;\n\n  /** React components (optional) */\n  components?: Record<string, React.ComponentType>;\n\n  /** Called when extension is loaded */\n  initialize?: () => Promise<void>;\n\n  /** Called when extension is unloaded */\n  cleanup?: () => Promise<void>;\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"extensionmetadata",children:"ExtensionMetadata"}),"\n",(0,i.jsx)(n.p,{children:"Describes the extension for registration and display."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface ExtensionMetadata {\n  /** Unique identifier (e.g., 'my-extension') */\n  id: string;\n\n  /** Human-readable name */\n  name: string;\n\n  /** Semantic version (e.g., '1.0.0') */\n  version: string;\n\n  /** Description of what the extension does */\n  description?: string;\n\n  /** Package author */\n  author?: string;\n\n  /** Documentation or homepage URL */\n  homepage?: string;\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"extensionroute",children:"ExtensionRoute"}),"\n",(0,i.jsx)(n.p,{children:"Defines an API endpoint provided by the extension."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface ExtensionRoute {\n  /** URL path (must start with /api/ext/{extension-name}/) */\n  path: string;\n\n  /** HTTP method */\n  method: 'GET' | 'POST' | 'PUT' | 'DELETE' | 'PATCH';\n\n  /** Request handler function */\n  handler: RouteHandler;\n\n  /** Middleware IDs to apply to this route (optional) */\n  middleware?: string[];\n}\n\n/** Route handler function signature */\ntype RouteHandler = (\n  request: NextRequest,\n  context?: RouteContext\n) => Promise<NextResponse>;\n\n/** Context passed to route handlers */\ninterface RouteContext {\n  params?: Record<string, string | string[]>;\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"extensionmiddleware",children:"ExtensionMiddleware"}),"\n",(0,i.jsx)(n.p,{children:"Defines middleware that processes requests."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface ExtensionMiddleware {\n  /** Optional identifier for referencing this middleware */\n  id?: string;\n\n  /** URL pattern to match (supports wildcards) */\n  path: string;\n\n  /** Middleware handler function */\n  handler: MiddlewareHandler;\n\n  /** Execution priority (lower = earlier, default: 100) */\n  priority?: number;\n}\n\n/** Middleware handler function signature */\ntype MiddlewareHandler = (\n  request: NextRequest,\n  next: () => Promise<NextResponse>\n) => Promise<NextResponse>;\n"})}),"\n",(0,i.jsx)(n.h3,{id:"extensionfeature",children:"ExtensionFeature"}),"\n",(0,i.jsx)(n.p,{children:"Feature flags that extensions can provide."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"type ExtensionFeature =\n  // Built-in features\n  | 'billing'\n  | 'stripe_integration'\n  | 'subscription_management'\n  | 'usage_tracking'\n  | 'atlas_provisioning'\n  | 'premium_support'\n  | 'advanced_analytics'\n  | 'sso_authentication'\n  | 'audit_logging'\n  | 'custom_branding'\n  // Custom features (must use this prefix)\n  | `custom:${string}`;\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"registry-functions",children:"Registry Functions"}),"\n",(0,i.jsx)(n.h3,{id:"registerextension",children:"registerExtension"}),"\n",(0,i.jsx)(n.p,{children:"Registers an extension with the system."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"function registerExtension(extension: NetPadExtension): void\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"extension"})," - The extension object to register"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import { registerExtension } from '@/lib/extensions/registry';\n\nregisterExtension(myExtension);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"getextension",children:"getExtension"}),"\n",(0,i.jsx)(n.p,{children:"Retrieves a registered extension by ID."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"function getExtension(id: string): NetPadExtension | undefined\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"id"})," - Extension ID (from metadata.id)"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Returns:"})," The extension object or undefined"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const ext = getExtension('my-extension');\nif (ext) {\n  console.log(ext.metadata.name);\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"isfeatureavailable",children:"isFeatureAvailable"}),"\n",(0,i.jsx)(n.p,{children:"Checks if a feature is available."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"function isFeatureAvailable(feature: ExtensionFeature): boolean\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"feature"})," - Feature identifier to check"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Returns:"})," true if any extension provides this feature"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"if (isFeatureAvailable('billing')) {\n  // Show billing UI\n}\n\nif (isFeatureAvailable('custom:my_feature')) {\n  // Show custom feature\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"getfeatureavailability",children:"getFeatureAvailability"}),"\n",(0,i.jsx)(n.p,{children:"Gets detailed information about a feature's availability."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"function getFeatureAvailability(feature: ExtensionFeature): {\n  available: boolean;\n  provider?: string;\n  message?: string;\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"feature"})," - Feature identifier to check"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Returns:"})," Object with availability details"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const { available, provider, message } = getFeatureAvailability('billing');\nif (!available) {\n  console.log(message); // \"Feature requires extension that is not installed\"\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"getextensionroutes",children:"getExtensionRoutes"}),"\n",(0,i.jsx)(n.p,{children:"Returns all routes from all extensions."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"function getExtensionRoutes(): ExtensionRoute[]\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Returns:"})," Array of all registered routes"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const routes = getExtensionRoutes();\nroutes.forEach(route => {\n  console.log(`${route.method} ${route.path}`);\n});\n"})}),"\n",(0,i.jsx)(n.h3,{id:"getextensionmiddleware",children:"getExtensionMiddleware"}),"\n",(0,i.jsx)(n.p,{children:"Returns all middleware from all extensions, sorted by priority."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"function getExtensionMiddleware(): ExtensionMiddleware[]\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Returns:"})," Array of middleware sorted by priority (lower first)"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const middleware = getExtensionMiddleware();\n// Middleware is already sorted, first items run first\n"})}),"\n",(0,i.jsx)(n.h3,{id:"getservice",children:"getService"}),"\n",(0,i.jsx)(n.p,{children:"Retrieves a service from an extension."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"function getService<T>(extensionId: string, serviceName: string): T | undefined\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Type Parameters:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"T"})," - Expected service type"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"extensionId"})," - Extension ID"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"serviceName"})," - Service name (key in services object)"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Returns:"})," The service instance or undefined"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface MyService {\n  doSomething(): Promise<void>;\n}\n\nconst service = getService<MyService>('my-extension', 'myService');\nif (service) {\n  await service.doSomething();\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"getregistrystatus",children:"getRegistryStatus"}),"\n",(0,i.jsx)(n.p,{children:"Returns current registry state for debugging."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"function getRegistryStatus(): {\n  extensionCount: number;\n  extensions: Array<{\n    id: string;\n    name: string;\n    version: string;\n    features: string[];\n    routeCount: number;\n  }>;\n  features: string[];\n  initialized: boolean;\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Returns:"})," Registry status object"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const status = getRegistryStatus();\nconsole.log(`Loaded ${status.extensionCount} extensions`);\nconsole.log(`Features: ${status.features.join(', ')}`);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"initializeextensions",children:"initializeExtensions"}),"\n",(0,i.jsx)(n.p,{children:"Initializes all registered extensions."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"async function initializeExtensions(): Promise<void>\n"})}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsx)(n.p,{children:"This is typically called automatically by the loader."})}),"\n",(0,i.jsx)(n.h3,{id:"cleanupextensions",children:"cleanupExtensions"}),"\n",(0,i.jsx)(n.p,{children:"Calls cleanup on all extensions."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"async function cleanupExtensions(): Promise<void>\n"})}),"\n",(0,i.jsx)(n.h3,{id:"resetregistry",children:"resetRegistry"}),"\n",(0,i.jsx)(n.p,{children:"Resets the registry to initial state (for testing)."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"function resetRegistry(): void\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"loader-functions",children:"Loader Functions"}),"\n",(0,i.jsx)(n.h3,{id:"loadextensions",children:"loadExtensions"}),"\n",(0,i.jsx)(n.p,{children:"Loads all available extensions."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"async function loadExtensions(): Promise<void>\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Behavior:"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Loads cloud extension if ",(0,i.jsx)(n.code,{children:"NETPAD_CLOUD=true"})]}),"\n",(0,i.jsxs)(n.li,{children:["Loads extensions from ",(0,i.jsx)(n.code,{children:"NETPAD_EXTENSIONS"})," environment variable"]}),"\n",(0,i.jsx)(n.li,{children:"Initializes all loaded extensions"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import { loadExtensions } from '@/lib/extensions/loader';\n\nawait loadExtensions();\n"})}),"\n",(0,i.jsx)(n.h3,{id:"extensionsloaded",children:"extensionsLoaded"}),"\n",(0,i.jsx)(n.p,{children:"Checks if extensions have been loaded."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"function extensionsLoaded(): boolean\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Returns:"})," true if loadExtensions() has been called"]}),"\n",(0,i.jsx)(n.h3,{id:"waitforextensions",children:"waitForExtensions"}),"\n",(0,i.jsx)(n.p,{children:"Waits for extension loading to complete."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"async function waitForExtensions(): Promise<void>\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"await waitForExtensions();\n// Now safe to use extension features\n"})}),"\n",(0,i.jsx)(n.h3,{id:"registerextensionmanually",children:"registerExtensionManually"}),"\n",(0,i.jsx)(n.p,{children:"Registers an extension programmatically."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"async function registerExtensionManually(extension: NetPadExtension): Promise<void>\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"extension"})," - Extension to register"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// For testing or dynamic registration\nawait registerExtensionManually(myTestExtension);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"resetloader",children:"resetLoader"}),"\n",(0,i.jsx)(n.p,{children:"Resets loader state (for testing)."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"function resetLoader(): void\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"environment-variables",children:"Environment Variables"}),"\n",(0,i.jsx)(n.h3,{id:"netpad_cloud",children:"NETPAD_CLOUD"}),"\n",(0,i.jsx)(n.p,{children:"Enables cloud mode and loads cloud extension."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"NETPAD_CLOUD=true\n"})}),"\n",(0,i.jsx)(n.h3,{id:"netpad_extensions",children:"NETPAD_EXTENSIONS"}),"\n",(0,i.jsx)(n.p,{children:"Comma-separated list of extension packages to load."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"NETPAD_EXTENSIONS=@netpad/collaborate,@myorg/my-extension\n"})}),"\n",(0,i.jsx)(n.h3,{id:"netpad_self_hosted",children:"NETPAD_SELF_HOSTED"}),"\n",(0,i.jsx)(n.p,{children:"Indicates self-hosted deployment (disables cloud features)."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"NETPAD_SELF_HOSTED=true\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"route-handler-patterns",children:"Route Handler Patterns"}),"\n",(0,i.jsx)(n.h3,{id:"basic-get-handler",children:"Basic GET Handler"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"async function handleGet(request: NextRequest): Promise<NextResponse> {\n  try {\n    const data = await fetchData();\n    return NextResponse.json({ success: true, data });\n  } catch (error) {\n    return NextResponse.json(\n      { success: false, error: 'Failed to fetch data' },\n      { status: 500 }\n    );\n  }\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"post-handler-with-body-parsing",children:"POST Handler with Body Parsing"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"async function handlePost(request: NextRequest): Promise<NextResponse> {\n  try {\n    const body = await request.json();\n\n    // Validate\n    if (!body.name) {\n      return NextResponse.json(\n        { success: false, error: 'Name is required' },\n        { status: 400 }\n      );\n    }\n\n    const result = await createData(body);\n    return NextResponse.json({ success: true, data: result });\n  } catch (error) {\n    return NextResponse.json(\n      { success: false, error: 'Failed to create' },\n      { status: 500 }\n    );\n  }\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"handler-with-url-parameters",children:"Handler with URL Parameters"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"async function handleGetById(\n  request: NextRequest,\n  context?: { params?: Record<string, string | string[]> }\n): Promise<NextResponse> {\n  // Extract ID from URL\n  const url = new URL(request.url);\n  const pathParts = url.pathname.split('/');\n  const id = pathParts[pathParts.length - 1];\n\n  const data = await getById(id);\n\n  if (!data) {\n    return NextResponse.json(\n      { success: false, error: 'Not found' },\n      { status: 404 }\n    );\n  }\n\n  return NextResponse.json({ success: true, data });\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"handler-with-query-parameters",children:"Handler with Query Parameters"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"async function handleSearch(request: NextRequest): Promise<NextResponse> {\n  const { searchParams } = new URL(request.url);\n\n  const query = searchParams.get('q') || '';\n  const limit = parseInt(searchParams.get('limit') || '10');\n  const offset = parseInt(searchParams.get('offset') || '0');\n\n  const results = await search(query, { limit, offset });\n\n  return NextResponse.json({\n    success: true,\n    results,\n    pagination: { limit, offset, total: results.total },\n  });\n}\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"middleware-patterns",children:"Middleware Patterns"}),"\n",(0,i.jsx)(n.h3,{id:"authentication-middleware",children:"Authentication Middleware"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const authMiddleware: ExtensionMiddleware = {\n  id: 'my-extension:auth',\n  path: '/api/ext/my-extension/*',\n  priority: 10,\n  handler: async (request, next) => {\n    const token = request.headers.get('authorization');\n\n    if (!token) {\n      return NextResponse.json(\n        { error: 'Unauthorized' },\n        { status: 401 }\n      );\n    }\n\n    // Verify token...\n    const isValid = await verifyToken(token);\n\n    if (!isValid) {\n      return NextResponse.json(\n        { error: 'Invalid token' },\n        { status: 401 }\n      );\n    }\n\n    return next();\n  },\n};\n"})}),"\n",(0,i.jsx)(n.h3,{id:"logging-middleware",children:"Logging Middleware"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const loggingMiddleware: ExtensionMiddleware = {\n  id: 'my-extension:logging',\n  path: '/api/ext/my-extension/*',\n  priority: 1, // Run first\n  handler: async (request, next) => {\n    const start = Date.now();\n\n    console.log(`[${request.method}] ${request.url}`);\n\n    const response = await next();\n\n    console.log(`[${request.method}] ${request.url} - ${Date.now() - start}ms`);\n\n    return response;\n  },\n};\n"})}),"\n",(0,i.jsx)(n.h3,{id:"rate-limiting-middleware",children:"Rate Limiting Middleware"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const rateLimits = new Map<string, { count: number; resetAt: number }>();\n\nconst rateLimitMiddleware: ExtensionMiddleware = {\n  id: 'my-extension:rate-limit',\n  path: '/api/ext/my-extension/*',\n  priority: 5,\n  handler: async (request, next) => {\n    const ip = request.headers.get('x-forwarded-for') || 'unknown';\n    const now = Date.now();\n    const limit = rateLimits.get(ip);\n\n    if (limit && limit.resetAt > now && limit.count >= 100) {\n      return NextResponse.json(\n        { error: 'Too many requests' },\n        { status: 429 }\n      );\n    }\n\n    if (!limit || limit.resetAt <= now) {\n      rateLimits.set(ip, { count: 1, resetAt: now + 60000 });\n    } else {\n      limit.count++;\n    }\n\n    return next();\n  },\n};\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"component-export-patterns",children:"Component Export Patterns"}),"\n",(0,i.jsx)(n.h3,{id:"basic-component-export",children:"Basic Component Export"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// src/components/index.ts\nexport { MyComponent } from './MyComponent';\nexport type { MyComponentProps } from './MyComponent';\n"})}),"\n",(0,i.jsx)(n.h3,{id:"with-component-ids",children:"With Component IDs"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// src/components/index.ts\nexport { MyComponent } from './MyComponent';\nexport type { MyComponentProps } from './MyComponent';\n\nexport const MY_EXTENSION_COMPONENTS = {\n  MY_COMPONENT: 'my-extension:my-component',\n} as const;\n\nexport type MyExtensionComponentId =\n  (typeof MY_EXTENSION_COMPONENTS)[keyof typeof MY_EXTENSION_COMPONENTS];\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"type-utilities",children:"Type Utilities"}),"\n",(0,i.jsx)(n.h3,{id:"type-safe-service-access",children:"Type-Safe Service Access"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// Define service interface\ninterface MyService {\n  getData(): Promise<Data[]>;\n  createData(data: CreateData): Promise<Data>;\n}\n\n// Type-safe access\nfunction getMyService(): MyService | undefined {\n  return getService<MyService>('my-extension', 'myService');\n}\n\n// Usage\nconst service = getMyService();\nif (service) {\n  const data = await service.getData();\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"extension-type-guards",children:"Extension Type Guards"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"function isValidExtension(obj: unknown): obj is NetPadExtension {\n  if (!obj || typeof obj !== 'object') return false;\n\n  const ext = obj as Partial<NetPadExtension>;\n\n  return (\n    typeof ext.metadata?.id === 'string' &&\n    typeof ext.metadata?.name === 'string' &&\n    typeof ext.metadata?.version === 'string' &&\n    Array.isArray(ext.features)\n  );\n}\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,i.jsx)(n.h3,{id:"standard-error-response",children:"Standard Error Response"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface ErrorResponse {\n  success: false;\n  error: string;\n  code?: string;\n  details?: unknown;\n}\n\nfunction errorResponse(\n  message: string,\n  status: number = 500,\n  code?: string\n): NextResponse<ErrorResponse> {\n  return NextResponse.json(\n    { success: false, error: message, code },\n    { status }\n  );\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"error-codes",children:"Error Codes"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Code"}),(0,i.jsx)(n.th,{children:"HTTP Status"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"UNAUTHORIZED"})}),(0,i.jsx)(n.td,{children:"401"}),(0,i.jsx)(n.td,{children:"Missing or invalid authentication"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"FORBIDDEN"})}),(0,i.jsx)(n.td,{children:"403"}),(0,i.jsx)(n.td,{children:"Authenticated but not allowed"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"NOT_FOUND"})}),(0,i.jsx)(n.td,{children:"404"}),(0,i.jsx)(n.td,{children:"Resource not found"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"VALIDATION_ERROR"})}),(0,i.jsx)(n.td,{children:"400"}),(0,i.jsx)(n.td,{children:"Invalid input data"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"RATE_LIMITED"})}),(0,i.jsx)(n.td,{children:"429"}),(0,i.jsx)(n.td,{children:"Too many requests"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"INTERNAL_ERROR"})}),(0,i.jsx)(n.td,{children:"500"}),(0,i.jsx)(n.td,{children:"Server error"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"FEATURE_UNAVAILABLE"})}),(0,i.jsx)(n.td,{children:"400"}),(0,i.jsx)(n.td,{children:"Required feature not loaded"})]})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"workflow-node-types",children:"Workflow Node Types"}),"\n",(0,i.jsx)(n.h3,{id:"workflownodedefinition",children:"WorkflowNodeDefinition"}),"\n",(0,i.jsx)(n.p,{children:"Defines a custom workflow node for the palette and execution."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface WorkflowNodeDefinition {\n  /** Unique node type identifier (e.g., 'custom:my-node') */\n  type: string;\n\n  /** Display label in palette */\n  label: string;\n\n  /** Description shown in tooltip */\n  description: string;\n\n  /** Category for grouping in palette */\n  category: NodeCategory;\n\n  /** Node color in hex format */\n  color: string;\n\n  /** MUI icon name */\n  icon: string;\n\n  /** Configuration fields for the node settings panel */\n  configFields?: NodeConfigField[];\n\n  /** Output handles (defaults to single 'output' handle) */\n  outputs?: NodeOutput[];\n\n  /** Whether this node supports multiple inputs */\n  multipleInputs?: boolean;\n\n  /** Extension that provides this node */\n  providedBy: string;\n\n  /** Version of the node definition */\n  version: string;\n\n  /** Documentation URL */\n  docsUrl?: string;\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"nodeconfigfield",children:"NodeConfigField"}),"\n",(0,i.jsx)(n.p,{children:"Defines a configuration field for node settings."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface NodeConfigField {\n  /** Field name (key in config object) */\n  name: string;\n\n  /** Display label */\n  label: string;\n\n  /** Field type */\n  type: 'text' | 'textarea' | 'number' | 'boolean' | 'select' | 'json' | 'connection' | 'expression';\n\n  /** Default value */\n  defaultValue?: unknown;\n\n  /** Placeholder text */\n  placeholder?: string;\n\n  /** Help text shown below field */\n  helpText?: string;\n\n  /** Whether field is required */\n  required?: boolean;\n\n  /** Options for select fields */\n  options?: Array<{ label: string; value: string }>;\n\n  /** Validation rules */\n  validation?: {\n    min?: number;\n    max?: number;\n    pattern?: string;\n    message?: string;\n  };\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"nodeoutput",children:"NodeOutput"}),"\n",(0,i.jsx)(n.p,{children:"Defines an output handle for a node."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface NodeOutput {\n  /** Output handle ID */\n  id: string;\n\n  /** Display label */\n  label: string;\n\n  /** Description of what this output contains */\n  description?: string;\n\n  /** Whether this is the default/primary output */\n  primary?: boolean;\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"nodehandler",children:"NodeHandler"}),"\n",(0,i.jsx)(n.p,{children:"The function that executes when the node runs in a workflow."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"type NodeHandler = (context: NodeExecutionContext) => Promise<NodeExecutionResult>;\n"})}),"\n",(0,i.jsx)(n.h3,{id:"nodeexecutioncontext",children:"NodeExecutionContext"}),"\n",(0,i.jsx)(n.p,{children:"Context passed to node handlers during execution."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface NodeExecutionContext {\n  /** ID of the current node instance */\n  nodeId: string;\n\n  /** Type of the node */\n  nodeType: string;\n\n  /** Raw node configuration */\n  config: Record<string, unknown>;\n\n  /** Configuration with template variables resolved */\n  resolvedConfig: Record<string, unknown>;\n\n  /** Data from previous nodes */\n  inputs: Record<string, unknown>;\n\n  /** Information about the workflow trigger */\n  trigger: {\n    type: string;\n    payload?: Record<string, unknown>;\n  };\n\n  /** Get a decrypted connection from the vault */\n  getConnection: (vaultId: string) => Promise<{\n    connectionString: string;\n    database: string;\n  } | null>;\n\n  /** Get email credentials from the integration vault */\n  getEmailCredentials: (credentialId: string) => Promise<unknown>;\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"nodeexecutionresult",children:"NodeExecutionResult"}),"\n",(0,i.jsx)(n.p,{children:"Result returned by a node handler."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface NodeExecutionResult {\n  /** Whether the node executed successfully */\n  success: boolean;\n\n  /** Output data passed to downstream nodes */\n  data: Record<string, unknown>;\n\n  /** Error information if failed */\n  error?: {\n    code: string;\n    message: string;\n    retryable: boolean;\n  };\n\n  /** Execution metadata */\n  metadata?: {\n    durationMs?: number;\n    bytesProcessed?: number;\n  };\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"extensionworkflownode",children:"ExtensionWorkflowNode"}),"\n",(0,i.jsx)(n.p,{children:"The structure for registering a workflow node in an extension."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface ExtensionWorkflowNode {\n  /** Node definition for UI */\n  definition: Omit<WorkflowNodeDefinition, 'providedBy'>;\n\n  /** Node execution handler */\n  handler: NodeHandler;\n}\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"workflow-node-registry-functions",children:"Workflow Node Registry Functions"}),"\n",(0,i.jsx)(n.h3,{id:"registerextensionnode",children:"registerExtensionNode"}),"\n",(0,i.jsx)(n.p,{children:"Registers a custom workflow node from an extension."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"function registerExtensionNode(\n  definition: WorkflowNodeDefinition,\n  handler: NodeHandler,\n  extensionId: string\n): void\n"})}),"\n",(0,i.jsx)(n.h3,{id:"getextensionnodedefinitions",children:"getExtensionNodeDefinitions"}),"\n",(0,i.jsx)(n.p,{children:"Returns all extension-provided node definitions."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"function getExtensionNodeDefinitions(): WorkflowNodeDefinition[]\n"})}),"\n",(0,i.jsx)(n.h3,{id:"getextensionnodesbycategory",children:"getExtensionNodesByCategory"}),"\n",(0,i.jsx)(n.p,{children:"Returns extension nodes filtered by category."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"function getExtensionNodesByCategory(\n  category: NodeCategory\n): WorkflowNodeDefinition[]\n"})}),"\n",(0,i.jsx)(n.h3,{id:"isextensionnode",children:"isExtensionNode"}),"\n",(0,i.jsx)(n.p,{children:"Checks if a node type is provided by an extension."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"function isExtensionNode(nodeType: string): boolean\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"./building-extensions",children:"Building Extensions"})," - Step-by-step tutorial"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"./example-collaborate",children:"Example: Collaborate Extension"})," - Real-world walkthrough"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"./architecture",children:"Extension Architecture"})," - System internals"]}),"\n"]})]})}function x(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>a});var s=t(6540);const i={},r=s.createContext(i);function o(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);