"use strict";(self.webpackChunkdocs_netpad_io=self.webpackChunkdocs_netpad_io||[]).push([[1053],{2355:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"extensions/workflow-nodes","title":"Workflow Node Extensions","description":"Extensions can provide custom workflow nodes that integrate seamlessly with NetPad\'s workflow editor. This guide covers everything you need to know about creating, configuring, and deploying workflow node extensions.","source":"@site/docs/extensions/workflow-nodes.md","sourceDirName":"extensions","slug":"/extensions/workflow-nodes","permalink":"/docs/extensions/workflow-nodes","draft":false,"unlisted":false,"editUrl":"https://github.com/mrlynn/netpad-v3/tree/main/docs/docs/extensions/workflow-nodes.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"docs","previous":{"title":"\ud83d\udd28 Building Extensions","permalink":"/docs/extensions/building-extensions"},"next":{"title":"\ud83d\udce1 API Reference","permalink":"/docs/extensions/api-reference"}}');var r=s(4848),d=s(8453);const t={sidebar_position:4},l="Workflow Node Extensions",o={},c=[{value:"Overview",id:"overview",level:2},{value:"Quick Start",id:"quick-start",level:2},{value:"1. Create the Node Handler",id:"1-create-the-node-handler",level:3},{value:"2. Define the Node UI",id:"2-define-the-node-ui",level:3},{value:"3. Register in Extension",id:"3-register-in-extension",level:3},{value:"Node Definition Reference",id:"node-definition-reference",level:2},{value:"Required Fields",id:"required-fields",level:3},{value:"Optional Fields",id:"optional-fields",level:3},{value:"Categories",id:"categories",level:3},{value:"Available Icons",id:"available-icons",level:3},{value:"Configuration Fields",id:"configuration-fields",level:2},{value:"Field Types",id:"field-types",level:3},{value:"Text Field",id:"text-field",level:4},{value:"Textarea Field",id:"textarea-field",level:4},{value:"Number Field",id:"number-field",level:4},{value:"Boolean Field",id:"boolean-field",level:4},{value:"Select Field",id:"select-field",level:4},{value:"Field Properties",id:"field-properties",level:3},{value:"Node Handler Reference",id:"node-handler-reference",level:2},{value:"Context Object",id:"context-object",level:3},{value:"Result Object",id:"result-object",level:3},{value:"Error Codes",id:"error-codes",level:3},{value:"Accessing Upstream Data",id:"accessing-upstream-data",level:3},{value:"Using Variables",id:"using-variables",level:3},{value:"UI Integration Details",id:"ui-integration-details",level:2},{value:"How Extension Nodes Appear",id:"how-extension-nodes-appear",level:3},{value:"Node Data Storage",id:"node-data-storage",level:3},{value:"Real-World Example: Notify Collaborators",id:"real-world-example-notify-collaborators",level:2},{value:"Debugging",id:"debugging",level:2},{value:"Check Node Registration",id:"check-node-registration",level:3},{value:"Common Issues",id:"common-issues",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Next Steps",id:"next-steps",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"workflow-node-extensions",children:"Workflow Node Extensions"})}),"\n",(0,r.jsx)(n.p,{children:"Extensions can provide custom workflow nodes that integrate seamlessly with NetPad's workflow editor. This guide covers everything you need to know about creating, configuring, and deploying workflow node extensions."}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:"Workflow nodes are the building blocks of NetPad workflows. Each node:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Appears in the ",(0,r.jsx)(n.strong,{children:"Node Palette"})," for users to drag onto the canvas"]}),"\n",(0,r.jsxs)(n.li,{children:["Has a ",(0,r.jsx)(n.strong,{children:"configuration panel"})," where users set options"]}),"\n",(0,r.jsxs)(n.li,{children:["Executes ",(0,r.jsx)(n.strong,{children:"custom logic"})," when the workflow runs"]}),"\n",(0,r.jsxs)(n.li,{children:["Passes ",(0,r.jsx)(n.strong,{children:"data"})," to downstream nodes"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Extension nodes work exactly like built-in nodes, with full support for:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Custom colors and icons"}),"\n",(0,r.jsx)(n.li,{children:"Configuration fields with variable support"}),"\n",(0,r.jsx)(n.li,{children:"Error handling and retry policies"}),"\n",(0,r.jsx)(n.li,{children:"Data output to downstream nodes"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,r.jsx)(n.h3,{id:"1-create-the-node-handler",children:"1. Create the Node Handler"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// src/nodes/myNode.ts\n\ninterface NodeExecutionResult {\n  success: boolean;\n  data: Record<string, unknown>;\n  error?: { code: string; message: string; retryable: boolean };\n  metadata?: { durationMs?: number };\n}\n\ninterface NodeExecutionContext {\n  nodeId: string;\n  nodeType: string;\n  config: Record<string, unknown>;\n  resolvedConfig: Record<string, unknown>;  // Variables already substituted\n  inputs: Record<string, unknown>;           // Data from upstream nodes\n  trigger: { type: string; payload?: Record<string, unknown> };\n  getConnection: (vaultId: string) => Promise<{ connectionString: string; database: string } | null>;\n  getEmailCredentials: (credentialId: string) => Promise<unknown>;\n}\n\nexport type NodeHandler = (context: NodeExecutionContext) => Promise<NodeExecutionResult>;\n\nexport const myNodeHandler: NodeHandler = async (context) => {\n  const { message } = context.resolvedConfig as { message?: string };\n\n  if (!message) {\n    return {\n      success: false,\n      data: {},\n      error: { code: 'MISSING_CONFIG', message: 'Message is required', retryable: false },\n    };\n  }\n\n  return {\n    success: true,\n    data: { result: message.toUpperCase() },\n  };\n};\n"})}),"\n",(0,r.jsx)(n.h3,{id:"2-define-the-node-ui",children:"2. Define the Node UI"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"export const myNodeDefinition = {\n  type: 'my-ext:my-node',           // Namespaced type\n  label: 'My Custom Node',          // Display name\n  description: 'Does something',    // Tooltip\n  category: 'actions' as const,     // Palette category\n  color: '#FF5722',                 // Node color (hex)\n  icon: 'Extension',                // MUI icon name\n  version: '1.0.0',\n  configFields: [\n    {\n      name: 'message',\n      label: 'Message',\n      type: 'text' as const,\n      required: true,\n      placeholder: 'Enter message...',\n      helpText: 'Supports {{variable}} syntax',\n    },\n  ],\n  outputs: [\n    { id: 'output', label: 'Success', primary: true },\n  ],\n};\n"})}),"\n",(0,r.jsx)(n.h3,{id:"3-register-in-extension",children:"3. Register in Extension"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// src/index.ts\nimport { myNodeHandler, myNodeDefinition } from './nodes/myNode';\n\nexport const myExtension = {\n  metadata: { id: 'my-ext', name: 'My Extension', version: '1.0.0' },\n  workflowNodes: [\n    { definition: myNodeDefinition, handler: myNodeHandler },\n  ],\n};\n"})}),"\n",(0,r.jsx)(n.h2,{id:"node-definition-reference",children:"Node Definition Reference"}),"\n",(0,r.jsx)(n.h3,{id:"required-fields",children:"Required Fields"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Field"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"type"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"string"})}),(0,r.jsxs)(n.td,{children:["Unique identifier. ",(0,r.jsx)(n.strong,{children:"Must be namespaced"})," (e.g., ",(0,r.jsx)(n.code,{children:"my-ext:node-name"}),")"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"label"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"string"})}),(0,r.jsx)(n.td,{children:"Display name shown in the palette and on the node"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"description"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"string"})}),(0,r.jsx)(n.td,{children:"Tooltip shown when hovering over the node in the palette"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"category"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"string"})}),(0,r.jsx)(n.td,{children:"Category for grouping in the palette"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"color"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"string"})}),(0,r.jsxs)(n.td,{children:["Hex color code (e.g., ",(0,r.jsx)(n.code,{children:"#FF5722"}),")"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"icon"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"string"})}),(0,r.jsx)(n.td,{children:"MUI icon name"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"version"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"string"})}),(0,r.jsx)(n.td,{children:"Semantic version of the node"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"optional-fields",children:"Optional Fields"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Field"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Default"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"configFields"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"array"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"[]"})}),(0,r.jsx)(n.td,{children:"Configuration fields for the node settings panel"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"outputs"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"array"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"[{id:'output'}]"})}),(0,r.jsx)(n.td,{children:"Output handles for connecting to other nodes"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"multipleInputs"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"boolean"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"false"})}),(0,r.jsx)(n.td,{children:"Allow multiple input connections"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"docsUrl"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"string"})}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsx)(n.td,{children:"Link to documentation"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"categories",children:"Categories"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Category"}),(0,r.jsx)(n.th,{children:"Description"}),(0,r.jsx)(n.th,{children:"Color Suggestion"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"triggers"})}),(0,r.jsx)(n.td,{children:"Start workflow execution"}),(0,r.jsxs)(n.td,{children:["Green (",(0,r.jsx)(n.code,{children:"#4CAF50"}),")"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"logic"})}),(0,r.jsx)(n.td,{children:"Control flow (conditions, loops)"}),(0,r.jsxs)(n.td,{children:["Purple (",(0,r.jsx)(n.code,{children:"#9C27B0"}),")"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"integrations"})}),(0,r.jsx)(n.td,{children:"External service connections"}),(0,r.jsxs)(n.td,{children:["Orange (",(0,r.jsx)(n.code,{children:"#FF9800"}),")"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"actions"})}),(0,r.jsx)(n.td,{children:"Perform operations"}),(0,r.jsxs)(n.td,{children:["Blue (",(0,r.jsx)(n.code,{children:"#2196F3"}),")"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"data"})}),(0,r.jsx)(n.td,{children:"Transform/filter data"}),(0,r.jsxs)(n.td,{children:["Grey (",(0,r.jsx)(n.code,{children:"#607D8B"}),")"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"ai"})}),(0,r.jsx)(n.td,{children:"AI/ML operations"}),(0,r.jsxs)(n.td,{children:["Pink (",(0,r.jsx)(n.code,{children:"#E91E63"}),")"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"forms"})}),(0,r.jsx)(n.td,{children:"Form-related actions"}),(0,r.jsxs)(n.td,{children:["Cyan (",(0,r.jsx)(n.code,{children:"#00BCD4"}),")"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"custom"})}),(0,r.jsx)(n.td,{children:"Custom/code execution"}),(0,r.jsxs)(n.td,{children:["Brown (",(0,r.jsx)(n.code,{children:"#795548"}),")"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"annotations"})}),(0,r.jsx)(n.td,{children:"Notes and documentation"}),(0,r.jsxs)(n.td,{children:["Yellow (",(0,r.jsx)(n.code,{children:"#FBC02D"}),")"]})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"available-icons",children:"Available Icons"}),"\n",(0,r.jsx)(n.p,{children:"The following MUI icon names are supported:"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"General:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Extension"})," - Plugin/extension icon"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Code"})," - Code/development"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Settings"})," - Configuration"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Communication:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Email"})," - Email actions"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Notifications"})," - Alerts/notifications"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Http"})," - HTTP/web requests"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Link"})," - Webhooks/connections"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Data:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Storage"})," - Database operations"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Transform"})," - Data transformation"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"FilterList"})," - Filtering"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"MergeType"})," - Data merging"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"DataObject"})," - Data extraction"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"TableChart"})," - Spreadsheets"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Control Flow:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"CallSplit"})," - Conditional branching"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Loop"})," - Iteration"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Timer"})," - Delays"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Schedule"})," - Scheduling"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"PlayArrow"})," - Manual triggers"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"AI:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"SmartToy"})," - AI/ML operations"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Category"})," - Classification"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Other:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Description"})," - Forms/documents"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"StickyNote2"})," - Notes"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"configuration-fields",children:"Configuration Fields"}),"\n",(0,r.jsx)(n.h3,{id:"field-types",children:"Field Types"}),"\n",(0,r.jsx)(n.h4,{id:"text-field",children:"Text Field"}),"\n",(0,r.jsx)(n.p,{children:"Single-line text input with variable picker:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"{\n  name: 'url',\n  label: 'API URL',\n  type: 'text' as const,\n  required: true,\n  placeholder: 'https://api.example.com/...',\n  helpText: 'The endpoint to call',\n}\n"})}),"\n",(0,r.jsx)(n.h4,{id:"textarea-field",children:"Textarea Field"}),"\n",(0,r.jsx)(n.p,{children:"Multi-line text input:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"{\n  name: 'body',\n  label: 'Request Body',\n  type: 'textarea' as const,\n  placeholder: '{\"key\": \"{{nodes.previous.value}}\"}',\n  helpText: 'JSON body with variable support',\n}\n"})}),"\n",(0,r.jsx)(n.h4,{id:"number-field",children:"Number Field"}),"\n",(0,r.jsx)(n.p,{children:"Numeric input:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"{\n  name: 'timeout',\n  label: 'Timeout (ms)',\n  type: 'number' as const,\n  defaultValue: 5000,\n  helpText: 'Maximum time to wait',\n}\n"})}),"\n",(0,r.jsx)(n.h4,{id:"boolean-field",children:"Boolean Field"}),"\n",(0,r.jsx)(n.p,{children:"Toggle switch:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"{\n  name: 'enabled',\n  label: 'Enable Feature',\n  type: 'boolean' as const,\n  defaultValue: true,\n  helpText: 'Turn this feature on or off',\n}\n"})}),"\n",(0,r.jsx)(n.h4,{id:"select-field",children:"Select Field"}),"\n",(0,r.jsx)(n.p,{children:"Dropdown with options:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"{\n  name: 'method',\n  label: 'HTTP Method',\n  type: 'select' as const,\n  defaultValue: 'POST',\n  options: [\n    { label: 'GET', value: 'GET' },\n    { label: 'POST', value: 'POST' },\n    { label: 'PUT', value: 'PUT' },\n    { label: 'DELETE', value: 'DELETE' },\n  ],\n  helpText: 'Request method to use',\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"field-properties",children:"Field Properties"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Property"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Required"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"name"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"string"})}),(0,r.jsx)(n.td,{children:"Yes"}),(0,r.jsxs)(n.td,{children:["Config key (used in ",(0,r.jsx)(n.code,{children:"resolvedConfig"}),")"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"label"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"string"})}),(0,r.jsx)(n.td,{children:"Yes"}),(0,r.jsx)(n.td,{children:"Display label"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"type"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"string"})}),(0,r.jsx)(n.td,{children:"Yes"}),(0,r.jsx)(n.td,{children:"Field type"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"required"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"boolean"})}),(0,r.jsx)(n.td,{children:"No"}),(0,r.jsx)(n.td,{children:"Mark as required"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"placeholder"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"string"})}),(0,r.jsx)(n.td,{children:"No"}),(0,r.jsx)(n.td,{children:"Placeholder text"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"helpText"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"string"})}),(0,r.jsx)(n.td,{children:"No"}),(0,r.jsx)(n.td,{children:"Help text below field"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"defaultValue"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"unknown"})}),(0,r.jsx)(n.td,{children:"No"}),(0,r.jsx)(n.td,{children:"Default value"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"options"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"array"})}),(0,r.jsx)(n.td,{children:"For select"}),(0,r.jsx)(n.td,{children:"Dropdown options"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"node-handler-reference",children:"Node Handler Reference"}),"\n",(0,r.jsx)(n.h3,{id:"context-object",children:"Context Object"}),"\n",(0,r.jsx)(n.p,{children:"The handler receives a context object with:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"interface NodeExecutionContext {\n  // Node identification\n  nodeId: string;           // Unique instance ID\n  nodeType: string;         // Your node type (e.g., 'my-ext:my-node')\n\n  // Configuration\n  config: Record<string, unknown>;          // Raw config\n  resolvedConfig: Record<string, unknown>;  // Variables substituted\n\n  // Data flow\n  inputs: Record<string, unknown>;  // Data from upstream nodes\n\n  // Trigger info\n  trigger: {\n    type: string;                            // 'manual', 'form', 'webhook', 'schedule'\n    payload?: Record<string, unknown>;       // Trigger-specific data\n  };\n\n  // Utilities\n  getConnection: (vaultId: string) => Promise<{\n    connectionString: string;\n    database: string;\n  } | null>;\n  getEmailCredentials: (credentialId: string) => Promise<unknown>;\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"result-object",children:"Result Object"}),"\n",(0,r.jsx)(n.p,{children:"Return a result object:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"interface NodeExecutionResult {\n  success: boolean;\n  data: Record<string, unknown>;  // Output data for downstream nodes\n  error?: {\n    code: string;      // Error code (see below)\n    message: string;   // Human-readable message\n    retryable: boolean; // Should retry on failure?\n  };\n  metadata?: {\n    durationMs?: number;      // Execution time\n    bytesProcessed?: number;  // Data volume\n  };\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"error-codes",children:"Error Codes"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Code"}),(0,r.jsx)(n.th,{children:"When to Use"}),(0,r.jsx)(n.th,{children:"Retryable"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"MISSING_CONFIG"})}),(0,r.jsx)(n.td,{children:"Required config missing"}),(0,r.jsx)(n.td,{children:"No"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"INVALID_CONFIG"})}),(0,r.jsx)(n.td,{children:"Config value invalid"}),(0,r.jsx)(n.td,{children:"No"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"VALIDATION_ERROR"})}),(0,r.jsx)(n.td,{children:"Input data invalid"}),(0,r.jsx)(n.td,{children:"No"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"OPERATION_FAILED"})}),(0,r.jsx)(n.td,{children:"Operation failed (HTTP error, etc.)"}),(0,r.jsx)(n.td,{children:"Yes"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"CONNECTION_FAILED"})}),(0,r.jsx)(n.td,{children:"Cannot reach external service"}),(0,r.jsx)(n.td,{children:"Yes"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"TIMEOUT"})}),(0,r.jsx)(n.td,{children:"Operation timed out"}),(0,r.jsx)(n.td,{children:"Yes"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"RATE_LIMITED"})}),(0,r.jsx)(n.td,{children:"Hit rate limit"}),(0,r.jsx)(n.td,{children:"Yes"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"PERMISSION_DENIED"})}),(0,r.jsx)(n.td,{children:"Insufficient permissions"}),(0,r.jsx)(n.td,{children:"No"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"NOT_FOUND"})}),(0,r.jsx)(n.td,{children:"Resource not found"}),(0,r.jsx)(n.td,{children:"No"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"INTERNAL_ERROR"})}),(0,r.jsx)(n.td,{children:"Unexpected error"}),(0,r.jsx)(n.td,{children:"No"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"accessing-upstream-data",children:"Accessing Upstream Data"}),"\n",(0,r.jsxs)(n.p,{children:["Data from upstream nodes is available in ",(0,r.jsx)(n.code,{children:"context.inputs"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"export const myNodeHandler: NodeHandler = async (context) => {\n  // Access data from previous nodes\n  const upstreamData = context.inputs;\n\n  // Common patterns:\n  const formData = upstreamData['nodes.formTrigger.data'];\n  const previousResult = upstreamData['nodes.previousNode.result'];\n\n  // Process the data...\n};\n"})}),"\n",(0,r.jsx)(n.h3,{id:"using-variables",children:"Using Variables"}),"\n",(0,r.jsx)(n.p,{children:"Variables in config are automatically resolved before your handler runs:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'// User configures: "Hello {{nodes.formTrigger.data.name}}"\n// You receive: "Hello John"\n\nexport const myNodeHandler: NodeHandler = async (context) => {\n  const { message } = context.resolvedConfig;\n  // message is already "Hello John"\n};\n'})}),"\n",(0,r.jsx)(n.h2,{id:"ui-integration-details",children:"UI Integration Details"}),"\n",(0,r.jsx)(n.h3,{id:"how-extension-nodes-appear",children:"How Extension Nodes Appear"}),"\n",(0,r.jsx)(n.p,{children:"When your extension loads:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Node Palette"}),': Your node appears with an "Ext" badge in its category']}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Canvas"}),": When dragged, uses your custom color and icon"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Config Panel"}),": Shows your ",(0,r.jsx)(n.code,{children:"configFields"})," with the ",(0,r.jsx)(n.code,{children:"ExtensionNodeEditor"})]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"node-data-storage",children:"Node Data Storage"}),"\n",(0,r.jsx)(n.p,{children:"Extension metadata is stored in the node's config:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"{\n  id: 'my-ext:my-node_abc123',\n  type: 'my-ext:my-node',\n  position: { x: 100, y: 200 },\n  config: {\n    // Your config fields\n    message: 'Hello {{nodes.form.data.name}}',\n\n    // Extension metadata (internal, prefixed with _)\n    _extensionColor: '#FF5722',\n    _extensionIcon: '\ud83d\udd0c',\n    _providedBy: 'my-extension',\n  },\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"real-world-example-notify-collaborators",children:"Real-World Example: Notify Collaborators"}),"\n",(0,r.jsxs)(n.p,{children:["From the ",(0,r.jsx)(n.code,{children:"@netpad/collaborate"})," extension:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// src/nodes/notifyCollaborators.ts\n\nexport interface NotifyCollaboratorsConfig {\n  subject?: string;\n  message?: string;\n  channel?: 'email' | 'slack' | 'webhook';\n  audience?: 'all' | 'contributors' | 'reviewers';\n  webhookUrl?: string;\n}\n\nexport const notifyCollaboratorsHandler: NodeHandler = async (context) => {\n  const startTime = Date.now();\n  const config = context.resolvedConfig as NotifyCollaboratorsConfig;\n\n  // Validate\n  if (!config.message) {\n    return {\n      success: false,\n      data: {},\n      error: { code: 'MISSING_CONFIG', message: 'Message is required', retryable: false },\n    };\n  }\n\n  const channel = config.channel || 'email';\n  const audience = config.audience || 'all';\n\n  // If webhook, make the call\n  if (channel === 'webhook' && config.webhookUrl) {\n    try {\n      const response = await fetch(config.webhookUrl, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          subject: config.subject,\n          message: config.message,\n          audience,\n          timestamp: new Date().toISOString(),\n        }),\n      });\n\n      if (!response.ok) {\n        return {\n          success: false,\n          data: {},\n          error: {\n            code: 'OPERATION_FAILED',\n            message: `Webhook failed: ${response.status}`,\n            retryable: true,\n          },\n        };\n      }\n    } catch (err) {\n      return {\n        success: false,\n        data: {},\n        error: {\n          code: 'CONNECTION_FAILED',\n          message: err instanceof Error ? err.message : 'Unknown error',\n          retryable: true,\n        },\n      };\n    }\n  }\n\n  return {\n    success: true,\n    data: {\n      notification: { channel, audience, sentAt: new Date().toISOString() },\n    },\n    metadata: { durationMs: Date.now() - startTime },\n  };\n};\n\nexport const notifyCollaboratorsDefinition = {\n  type: 'collaborate:notify-collaborators',\n  label: 'Notify Collaborators',\n  description: 'Send notifications via email, Slack, or webhook',\n  category: 'actions' as const,\n  color: '#7C4DFF',\n  icon: 'Notifications',\n  version: '1.0.0',\n  configFields: [\n    {\n      name: 'subject',\n      label: 'Subject',\n      type: 'text' as const,\n      placeholder: 'Notification subject...',\n      helpText: 'Subject line for the notification',\n    },\n    {\n      name: 'message',\n      label: 'Message',\n      type: 'textarea' as const,\n      required: true,\n      placeholder: 'Enter your notification message...',\n      helpText: 'Use {{variable}} syntax for dynamic values',\n    },\n    {\n      name: 'channel',\n      label: 'Channel',\n      type: 'select' as const,\n      defaultValue: 'email',\n      options: [\n        { label: 'Email', value: 'email' },\n        { label: 'Slack', value: 'slack' },\n        { label: 'Webhook', value: 'webhook' },\n      ],\n      helpText: 'How to deliver the notification',\n    },\n    {\n      name: 'audience',\n      label: 'Audience',\n      type: 'select' as const,\n      defaultValue: 'all',\n      options: [\n        { label: 'All Collaborators', value: 'all' },\n        { label: 'Contributors Only', value: 'contributors' },\n        { label: 'Reviewers Only', value: 'reviewers' },\n      ],\n      helpText: 'Who should receive this notification',\n    },\n    {\n      name: 'webhookUrl',\n      label: 'Webhook URL',\n      type: 'text' as const,\n      placeholder: 'https://...',\n      helpText: 'Required when channel is Webhook',\n    },\n  ],\n  outputs: [{ id: 'output', label: 'Success', primary: true }],\n};\n"})}),"\n",(0,r.jsx)(n.h2,{id:"debugging",children:"Debugging"}),"\n",(0,r.jsx)(n.h3,{id:"check-node-registration",children:"Check Node Registration"}),"\n",(0,r.jsx)(n.p,{children:"View registered extension nodes at:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"GET /api/ext/workflow-nodes\n"})}),"\n",(0,r.jsx)(n.p,{children:"Response:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "data": {\n    "nodes": [\n      {\n        "type": "collaborate:notify-collaborators",\n        "label": "Notify Collaborators",\n        "category": "actions",\n        "providedBy": "netpad-collaborate",\n        "version": "1.0.0"\n      }\n    ],\n    "stats": {\n      "total": 1,\n      "byCategory": { "actions": 1 },\n      "byExtension": { "netpad-collaborate": 1 }\n    }\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"common-issues",children:"Common Issues"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Node doesn't appear in palette:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Check extension is loaded: ",(0,r.jsx)(n.code,{children:"GET /api/ext/status"})]}),"\n",(0,r.jsxs)(n.li,{children:["Verify ",(0,r.jsx)(n.code,{children:"workflowNodes"})," array in extension definition"]}),"\n",(0,r.jsx)(n.li,{children:"Check browser console for errors"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Config fields don't show:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Ensure ",(0,r.jsx)(n.code,{children:"configFields"})," array is defined"]}),"\n",(0,r.jsx)(n.li,{children:"Check field types are valid"}),"\n",(0,r.jsxs)(n.li,{children:["Verify extension node detection (type contains ",(0,r.jsx)(n.code,{children:":"}),")"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Handler not executing:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Check handler is exported and registered"}),"\n",(0,r.jsx)(n.li,{children:"Verify node type matches exactly"}),"\n",(0,r.jsx)(n.li,{children:"Check workflow execution logs"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Namespace your node types"})," - Use ",(0,r.jsx)(n.code,{children:"extension-name:node-name"})," format"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Validate early"})," - Check required config at the start of your handler"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Return meaningful errors"})," - Use appropriate error codes and messages"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:["Set ",(0,r.jsx)(n.code,{children:"retryable"})," correctly"]})," - Transient failures should be retryable"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Include metadata"})," - Track ",(0,r.jsx)(n.code,{children:"durationMs"})," for performance monitoring"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Document your fields"})," - Use clear ",(0,r.jsx)(n.code,{children:"helpText"})," for each config field"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Test thoroughly"})," - Cover success, validation, and error cases"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Keep handlers focused"})," - One node, one purpose"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"./example-demo-node",children:"Example: Demo Node Extension"})," - ",(0,r.jsx)(n.strong,{children:"Start here!"})," Simple, beginner-friendly walkthrough"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"./building-extensions",children:"Building Extensions"})," - Complete extension guide"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"./api-reference",children:"Extension API Reference"})," - Full API documentation"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"./example-collaborate",children:"Example: Collaborate Extension"})," - Production example"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>l});var i=s(6540);const r={},d=i.createContext(r);function t(e){const n=i.useContext(d);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(d.Provider,{value:n},e.children)}}}]);