"use strict";(self.webpackChunkdocs_netpad_io=self.webpackChunkdocs_netpad_io||[]).push([[2042],{2031:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"security/encryption","title":"Encryption","description":"NetPad implements multiple layers of encryption to protect your data, including connection vault encryption, field-level encryption using MongoDB Queryable Encryption, and data-in-transit protection.","source":"@site/docs/security/encryption.md","sourceDirName":"security","slug":"/security/encryption","permalink":"/docs/security/encryption","draft":false,"unlisted":false,"editUrl":"https://github.com/mrlynn/netpad-v3/tree/main/docs/docs/security/encryption.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"Security Overview","permalink":"/docs/security/overview"},"next":{"title":"Access Control","permalink":"/docs/security/access-control"}}');var s=i(4848),t=i(8453);const l={},d="Encryption",c={},o=[{value:"Connection Vault Encryption",id:"connection-vault-encryption",level:2},{value:"How It Works",id:"how-it-works",level:3},{value:"Configuration",id:"configuration",level:3},{value:"Security",id:"security",level:3},{value:"Field-Level Encryption",id:"field-level-encryption",level:2},{value:"MongoDB Queryable Encryption",id:"mongodb-queryable-encryption",level:3},{value:"Key Features",id:"key-features",level:3},{value:"Encryption Algorithms",id:"encryption-algorithms",level:3},{value:"Query Types",id:"query-types",level:3},{value:"Sensitivity Levels",id:"sensitivity-levels",level:3},{value:"Encryption Configuration",id:"encryption-configuration",level:3},{value:"Configuration Examples",id:"configuration-examples",level:3},{value:"Encrypted SSN Field (Searchable)",id:"encrypted-ssn-field-searchable",level:4},{value:"Encrypted Medical Records (No Query)",id:"encrypted-medical-records-no-query",level:4},{value:"Encrypted Bank Account",id:"encrypted-bank-account",level:4},{value:"Use Cases",id:"use-cases",level:3},{value:"Compliance Frameworks",id:"compliance-frameworks",level:2},{value:"Supported Frameworks",id:"supported-frameworks",level:3},{value:"Templates with Encryption",id:"templates-with-encryption",level:3},{value:"KMS Provider Setup",id:"kms-provider-setup",level:2},{value:"Option 1: Local KMS (Development Only)",id:"option-1-local-kms-development-only",level:3},{value:"Option 2: AWS KMS (Recommended for Production)",id:"option-2-aws-kms-recommended-for-production",level:3},{value:"Option 3: Azure Key Vault",id:"option-3-azure-key-vault",level:3},{value:"Option 4: Google Cloud KMS",id:"option-4-google-cloud-kms",level:3},{value:"MongoDB Requirements",id:"mongodb-requirements",level:3},{value:"Data in Transit",id:"data-in-transit",level:2},{value:"HTTPS",id:"https",level:3},{value:"MongoDB Connections",id:"mongodb-connections",level:3},{value:"Enabling Encryption in Forms",id:"enabling-encryption-in-forms",level:2},{value:"Via Form Builder UI",id:"via-form-builder-ui",level:3},{value:"Via API",id:"via-api",level:3},{value:"Via Templates",id:"via-templates",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Key Management",id:"key-management",level:3},{value:"Field Selection",id:"field-selection",level:3},{value:"Monitoring",id:"monitoring",level:3},{value:"Performance",id:"performance",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Common Issues",id:"common-issues",level:3},{value:"&quot;Encryption key not found&quot;",id:"encryption-key-not-found",level:4},{value:"&quot;Cannot query encrypted field&quot;",id:"cannot-query-encrypted-field",level:4},{value:"&quot;MongoDB version not supported&quot;",id:"mongodb-version-not-supported",level:4},{value:"Debug Mode",id:"debug-mode",level:3},{value:"Resources",id:"resources",level:2},{value:"Next Steps",id:"next-steps",level:2}];function a(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"encryption",children:"Encryption"})}),"\n",(0,s.jsx)(n.p,{children:"NetPad implements multiple layers of encryption to protect your data, including connection vault encryption, field-level encryption using MongoDB Queryable Encryption, and data-in-transit protection."}),"\n",(0,s.jsx)(n.h2,{id:"connection-vault-encryption",children:"Connection Vault Encryption"}),"\n",(0,s.jsx)(n.h3,{id:"how-it-works",children:"How It Works"}),"\n",(0,s.jsx)(n.p,{children:"Connection strings are encrypted using AES-256-GCM:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Encryption"}),": Before storage"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Decryption"}),": On-demand when needed"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Key Management"}),": Encryption keys never stored in database"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Algorithm"}),": AES-256-GCM (strong encryption)"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"configuration",children:"Configuration"}),"\n",(0,s.jsx)(n.p,{children:"Set encryption key in environment:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"VAULT_ENCRYPTION_KEY=base64-encoded-32-byte-key\n"})}),"\n",(0,s.jsx)(n.p,{children:"Generate key:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"openssl rand -base64 32\n"})}),"\n",(0,s.jsx)(n.h3,{id:"security",children:"Security"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Keys Never Exposed"}),": Keys only in environment"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Encrypted at Rest"}),": All connection strings encrypted"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Access Control"}),": Role-based access to connections"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"field-level-encryption",children:"Field-Level Encryption"}),"\n",(0,s.jsx)(n.h3,{id:"mongodb-queryable-encryption",children:"MongoDB Queryable Encryption"}),"\n",(0,s.jsxs)(n.p,{children:["NetPad supports MongoDB Queryable Encryption (formerly Client-Side Field Level Encryption / CSFLE) for protecting sensitive form data. Encryption happens ",(0,s.jsx)(n.strong,{children:"client-side"})," before data reaches the database, ensuring that even database administrators cannot read plaintext values."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510      \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510      \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   User Input    \u2502      \u2502  NetPad App     \u2502      \u2502   MongoDB       \u2502\n\u2502  SSN: 123-45-67 \u2502 \u2500\u2500\u2500\u25b6 \u2502  Encrypts SSN   \u2502 \u2500\u2500\u2500\u25b6 \u2502  Stores only    \u2502\n\u2502                 \u2502      \u2502  before insert  \u2502      \u2502  ciphertext     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518      \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518      \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,s.jsx)(n.h3,{id:"key-features",children:"Key Features"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Per-Field"}),": Encrypt specific fields"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Queryable"}),": Can query encrypted fields (with Indexed algorithm)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Automatic"}),": Encryption/decryption is automatic"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Transparent"}),": Works seamlessly with forms"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"encryption-algorithms",children:"Encryption Algorithms"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Algorithm"}),(0,s.jsx)(n.th,{children:"Query Support"}),(0,s.jsx)(n.th,{children:"Use Case"}),(0,s.jsx)(n.th,{children:"Security Level"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Indexed"})}),(0,s.jsx)(n.td,{children:"Equality queries"}),(0,s.jsx)(n.td,{children:"SSN lookups, email search"}),(0,s.jsx)(n.td,{children:"High"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Unindexed"})}),(0,s.jsx)(n.td,{children:"No queries"}),(0,s.jsx)(n.td,{children:"Medical records, bank accounts"}),(0,s.jsx)(n.td,{children:"Maximum"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Range"})}),(0,s.jsx)(n.td,{children:"Range queries"}),(0,s.jsx)(n.td,{children:"Salary ranges, dates"}),(0,s.jsx)(n.td,{children:"High (MongoDB 7.0+)"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"query-types",children:"Query Types"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Example"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"none"})}),(0,s.jsx)(n.td,{children:"Cannot query this field"}),(0,s.jsx)(n.td,{children:"Medical history"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"equality"})}),(0,s.jsx)(n.td,{children:"Exact match only"}),(0,s.jsx)(n.td,{children:"Find by SSN"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"range"})}),(0,s.jsx)(n.td,{children:"Greater/less than"}),(0,s.jsx)(n.td,{children:"Salary > $50,000"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"sensitivity-levels",children:"Sensitivity Levels"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Level"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Encryption"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"public"})}),(0,s.jsx)(n.td,{children:"No sensitive data"}),(0,s.jsx)(n.td,{children:"Not needed"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"internal"})}),(0,s.jsx)(n.td,{children:"Low sensitivity"}),(0,s.jsx)(n.td,{children:"Optional"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"confidential"})}),(0,s.jsx)(n.td,{children:"Medium sensitivity"}),(0,s.jsx)(n.td,{children:"Recommended"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"restricted"})}),(0,s.jsx)(n.td,{children:"High sensitivity (PII/PHI)"}),(0,s.jsx)(n.td,{children:"Required"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"secret"})}),(0,s.jsx)(n.td,{children:"Maximum sensitivity"}),(0,s.jsx)(n.td,{children:"Mandatory"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"encryption-configuration",children:"Encryption Configuration"}),"\n",(0,s.jsx)(n.p,{children:"Fields can be configured with encryption settings:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"interface FieldEncryptionConfig {\n  enabled: boolean;              // Enable encryption\n  algorithm: EncryptionAlgorithm;\n  queryType: EncryptedQueryType;\n  sensitivityLevel: DataSensitivityLevel;\n  compliance?: ComplianceFramework[];\n  contentionFactor?: number;     // For Indexed algorithm (1-8)\n  rangeMin?: number | string;    // For Range algorithm\n  rangeMax?: number | string;    // For Range algorithm\n  encryptionReason?: string;     // Audit trail\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"configuration-examples",children:"Configuration Examples"}),"\n",(0,s.jsx)(n.h4,{id:"encrypted-ssn-field-searchable",children:"Encrypted SSN Field (Searchable)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"{\n  path: 'ssn',\n  label: 'Social Security Number',\n  type: 'text',\n  required: true,\n  encryption: {\n    enabled: true,\n    algorithm: 'Indexed',           // Can search by SSN\n    queryType: 'equality',          // Exact match only\n    sensitivityLevel: 'secret',\n    compliance: ['HIPAA', 'GDPR', 'CCPA'],\n    contentionFactor: 4,            // Balance insert/query performance\n    encryptionReason: 'PII - SSN required for identity verification',\n  },\n}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"encrypted-medical-records-no-query",children:"Encrypted Medical Records (No Query)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"{\n  path: 'medicalHistory',\n  label: 'Medical History',\n  type: 'textarea',\n  encryption: {\n    enabled: true,\n    algorithm: 'Unindexed',         // Maximum security\n    queryType: 'none',              // Cannot be searched\n    sensitivityLevel: 'restricted',\n    compliance: ['HIPAA'],\n    encryptionReason: 'PHI - Protected health information',\n  },\n}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"encrypted-bank-account",children:"Encrypted Bank Account"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"{\n  path: 'accountNumber',\n  label: 'Bank Account Number',\n  type: 'text',\n  required: true,\n  encryption: {\n    enabled: true,\n    algorithm: 'Unindexed',         // Never needs to be searched\n    queryType: 'none',\n    sensitivityLevel: 'secret',\n    compliance: ['PCI-DSS', 'SOC2'],\n    encryptionReason: 'Financial data - Bank account for direct deposit',\n  },\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"use-cases",children:"Use Cases"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"PII Data"}),": Personal identifiable information (SSN, driver's license)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"PHI Data"}),": Protected health information (medical records, diagnoses)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Financial Data"}),": Bank accounts, credit card numbers, salaries"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Compliance"}),": Meet HIPAA, PCI-DSS, GDPR, SOC2, CCPA, FERPA requirements"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"compliance-frameworks",children:"Compliance Frameworks"}),"\n",(0,s.jsx)(n.h3,{id:"supported-frameworks",children:"Supported Frameworks"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Framework"}),(0,s.jsx)(n.th,{children:"Full Name"}),(0,s.jsx)(n.th,{children:"Use Case"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"HIPAA"})}),(0,s.jsx)(n.td,{children:"Health Insurance Portability and Accountability Act"}),(0,s.jsx)(n.td,{children:"Healthcare data (PHI)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"PCI-DSS"})}),(0,s.jsx)(n.td,{children:"Payment Card Industry Data Security Standard"}),(0,s.jsx)(n.td,{children:"Payment/financial data"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"GDPR"})}),(0,s.jsx)(n.td,{children:"General Data Protection Regulation"}),(0,s.jsx)(n.td,{children:"EU personal data"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"SOC2"})}),(0,s.jsx)(n.td,{children:"Service Organization Control 2"}),(0,s.jsx)(n.td,{children:"Security audits"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"CCPA"})}),(0,s.jsx)(n.td,{children:"California Consumer Privacy Act"}),(0,s.jsx)(n.td,{children:"California residents' data"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"FERPA"})}),(0,s.jsx)(n.td,{children:"Family Educational Rights and Privacy Act"}),(0,s.jsx)(n.td,{children:"Student records"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"templates-with-encryption",children:"Templates with Encryption"}),"\n",(0,s.jsx)(n.p,{children:"NetPad includes pre-built templates with encryption already configured:"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Template"}),(0,s.jsx)(n.th,{children:"Encrypted Fields"}),(0,s.jsx)(n.th,{children:"Compliance"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Patient Intake"}),(0,s.jsx)(n.td,{children:"SSN, DOB, Insurance, Medical Conditions"}),(0,s.jsx)(n.td,{children:"HIPAA, GDPR, CCPA"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Employee Onboarding"}),(0,s.jsx)(n.td,{children:"SSN, DOB, Bank Routing, Bank Account"}),(0,s.jsx)(n.td,{children:"GDPR, CCPA, PCI-DSS, SOC2"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Payment Form"}),(0,s.jsx)(n.td,{children:"Credit Card, CVV, Billing Address"}),(0,s.jsx)(n.td,{children:"PCI-DSS"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Student Enrollment"}),(0,s.jsx)(n.td,{children:"SSN, DOB, Parent Info"}),(0,s.jsx)(n.td,{children:"FERPA"})]})]})]}),"\n",(0,s.jsxs)(n.p,{children:["See ",(0,s.jsx)(n.a,{href:"/docs/developer/packages-templates",children:"@netpad/templates"})," for more details."]}),"\n",(0,s.jsx)(n.h2,{id:"kms-provider-setup",children:"KMS Provider Setup"}),"\n",(0,s.jsx)(n.p,{children:"To use field-level encryption, you must configure a Key Management Service (KMS) provider."}),"\n",(0,s.jsx)(n.h3,{id:"option-1-local-kms-development-only",children:"Option 1: Local KMS (Development Only)"}),"\n",(0,s.jsx)(n.admonition,{type:"warning",children:(0,s.jsx)(n.p,{children:"Local KMS is NOT secure for production. Use only for development/testing."})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# .env.local\nQE_KMS_PROVIDER=local\nQE_LOCAL_MASTER_KEY=<96-byte-base64-key>\nQE_KEY_VAULT_DB=encryption\nQE_KEY_VAULT_COLLECTION=__keyVault\n"})}),"\n",(0,s.jsx)(n.p,{children:"Generate a local master key:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"node -e \"console.log(require('crypto').randomBytes(96).toString('base64'))\"\n"})}),"\n",(0,s.jsx)(n.h3,{id:"option-2-aws-kms-recommended-for-production",children:"Option 2: AWS KMS (Recommended for Production)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# .env\nQE_KMS_PROVIDER=aws\nAWS_ACCESS_KEY_ID=AKIA...\nAWS_SECRET_ACCESS_KEY=...\nAWS_KMS_KEY_ARN=arn:aws:kms:us-east-1:123456789:key/12345678-1234-...\nAWS_KMS_KEY_REGION=us-east-1\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"AWS Setup Steps:"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Create a KMS key in AWS Console"}),"\n",(0,s.jsxs)(n.li,{children:["Create an IAM user with ",(0,s.jsx)(n.code,{children:"kms:Encrypt"})," and ",(0,s.jsx)(n.code,{children:"kms:Decrypt"})," permissions"]}),"\n",(0,s.jsx)(n.li,{children:"Copy the key ARN and credentials to environment variables"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"option-3-azure-key-vault",children:"Option 3: Azure Key Vault"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# .env\nQE_KMS_PROVIDER=azure\nAZURE_TENANT_ID=<tenant-id>\nAZURE_CLIENT_ID=<client-id>\nAZURE_CLIENT_SECRET=<secret>\nAZURE_KEY_VAULT_ENDPOINT=https://vault-name.vault.azure.net/\nAZURE_KEY_NAME=netpad-master-key\n"})}),"\n",(0,s.jsx)(n.h3,{id:"option-4-google-cloud-kms",children:"Option 4: Google Cloud KMS"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# .env\nQE_KMS_PROVIDER=gcp\nGCP_SERVICE_ACCOUNT_EMAIL=<email>\nGCP_PRIVATE_KEY=<private-key>\nGCP_PROJECT_ID=my-project\nGCP_LOCATION=global\nGCP_KEY_RING=netpad-keys\nGCP_KEY_NAME=master-key\n"})}),"\n",(0,s.jsx)(n.h3,{id:"mongodb-requirements",children:"MongoDB Requirements"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Feature"}),(0,s.jsx)(n.th,{children:"MongoDB Version"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Queryable Encryption"}),(0,s.jsx)(n.td,{children:"7.0+"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Legacy CSFLE"}),(0,s.jsx)(n.td,{children:"4.2+"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Range Queries"}),(0,s.jsx)(n.td,{children:"7.0+ (preview)"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"data-in-transit",children:"Data in Transit"}),"\n",(0,s.jsx)(n.h3,{id:"https",children:"HTTPS"}),"\n",(0,s.jsx)(n.p,{children:"All connections use HTTPS:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"TLS/SSL"}),": Encrypted connections"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Certificate"}),": Valid SSL certificate required"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Forced"}),": HTTP redirects to HTTPS"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"mongodb-connections",children:"MongoDB Connections"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"TLS"}),": MongoDB connections use TLS"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Certificate Validation"}),": Verify certificates"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Encrypted"}),": All data encrypted in transit"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"enabling-encryption-in-forms",children:"Enabling Encryption in Forms"}),"\n",(0,s.jsx)(n.h3,{id:"via-form-builder-ui",children:"Via Form Builder UI"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Open Form Settings"})," - Click the settings icon in the form builder"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Navigate to Security"}),' - Select the "Security" tab']}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Enable Field Encryption"})," - Toggle encryption for specific fields"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Configure Settings"})," - Set algorithm, query type, and compliance"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Save"})," - Encryption is enabled"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"via-api",children:"Via API"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Create form with encrypted fields\nconst form = await netpad.forms.create({\n  name: 'Secure Patient Intake',\n  fields: [\n    {\n      path: 'ssn',\n      label: 'Social Security Number',\n      type: 'text',\n      encryption: {\n        enabled: true,\n        algorithm: 'Indexed',\n        queryType: 'equality',\n        sensitivityLevel: 'secret',\n        compliance: ['HIPAA'],\n      },\n    },\n  ],\n});\n"})}),"\n",(0,s.jsx)(n.h3,{id:"via-templates",children:"Via Templates"}),"\n",(0,s.jsx)(n.p,{children:"Use pre-configured encrypted templates:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { getTemplateById } from '@netpad/templates';\n\nconst template = getTemplateById('patient-intake');\n// Template already has encryption configured for sensitive fields\n"})}),"\n",(0,s.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,s.jsx)(n.h3,{id:"key-management",children:"Key Management"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Rotate Keys"}),": Regularly rotate encryption keys"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Secure Storage"}),": Protect encryption keys in KMS"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Access Control"}),": Limit who can access master keys"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Backup Keys"}),": Maintain secure key backups"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"field-selection",children:"Field Selection"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Encrypt Sensitive Data"}),": SSN, DOB, financial info, medical records"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Choose Right Algorithm"}),": Use Indexed only if you need to query"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Document Reasons"}),": Include encryptionReason for audit trail"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Compliance Tagging"}),": Tag fields with applicable compliance frameworks"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"monitoring",children:"Monitoring"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Monitor Access"}),": Track who accesses encrypted data"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Audit Logs"}),": Enable audit logging for encryption operations"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Alert on Anomalies"}),": Set up alerts for unusual access patterns"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Regular Reviews"}),": Periodically review encryption configurations"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"performance",children:"Performance"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Contention Factor"}),": Tune for insert vs. query performance (1-8)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Selective Encryption"}),": Only encrypt fields that need it"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Index Strategy"}),": Plan indexes around encrypted field query patterns"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Test Performance"}),": Benchmark with your expected data volume"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,s.jsx)(n.h3,{id:"common-issues",children:"Common Issues"}),"\n",(0,s.jsx)(n.h4,{id:"encryption-key-not-found",children:'"Encryption key not found"'}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Ensure KMS provider environment variables are set"}),"\n",(0,s.jsx)(n.li,{children:"Verify the key vault collection exists in MongoDB"}),"\n",(0,s.jsx)(n.li,{children:"Check that the Data Encryption Key (DEK) was created"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"cannot-query-encrypted-field",children:'"Cannot query encrypted field"'}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Field may be using ",(0,s.jsx)(n.code,{children:"Unindexed"})," algorithm (no queries allowed)"]}),"\n",(0,s.jsxs)(n.li,{children:["Change to ",(0,s.jsx)(n.code,{children:"Indexed"})," algorithm if queries are needed"]}),"\n",(0,s.jsxs)(n.li,{children:["Ensure ",(0,s.jsx)(n.code,{children:"queryType"})," matches your query needs"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"mongodb-version-not-supported",children:'"MongoDB version not supported"'}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Queryable Encryption requires MongoDB 7.0+"}),"\n",(0,s.jsx)(n.li,{children:"For MongoDB 4.2-6.x, use legacy CSFLE mode"}),"\n",(0,s.jsx)(n.li,{children:"Range queries require MongoDB 7.0+"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"debug-mode",children:"Debug Mode"}),"\n",(0,s.jsx)(n.p,{children:"Enable encryption debug logging:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"DEBUG=netpad:encryption npm run dev\n"})}),"\n",(0,s.jsx)(n.h2,{id:"resources",children:"Resources"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.mongodb.com/docs/manual/core/queryable-encryption/",children:"MongoDB Queryable Encryption Documentation"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/docs/developer/packages-templates",children:"@netpad/templates Package"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.hhs.gov/hipaa/index.html",children:"HIPAA Compliance Guide"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.pcisecuritystandards.org/",children:"PCI-DSS Requirements"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://gdpr.eu/",children:"GDPR Official Text"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/docs/security/access-control",children:"Access Control"})," - Understand access control"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/docs/security/best-practices",children:"Best Practices"})," - Security best practices"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/docs/developer/packages-templates",children:"@netpad/templates"})," - Templates with encryption"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>d});var r=i(6540);const s={},t=r.createContext(s);function l(e){const n=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);